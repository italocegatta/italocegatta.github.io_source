---
title: Os gráficos que explicam nossos dados (histograma)
date: 2016-07-15
author: Ítalo Cegatta
tags:
  - readxl
  - dplyr
  - ggplot2
  - ggthemes
categories:
  - Gráficos
thumbnailImage: http://i.imgur.com/K3yIExe.png
coverImage: http://i.imgur.com/uZgwJc6.png
coverCaption: "Imagem: Fabián Alexis"
thumbnailImagePosition: top
metaAlignment: center
coverMeta: out
---



<p>Histogramas são usados para mostrar a frequência com que uma variável ocorre. Isto é muito interessante para mostrar qual a distribuição dos seus dados e podemos apresentar em forma de frequência absoluta, relativa, percentual e acumulada. Para exemplificar este tipo gráfico, vamos utilizar os dados de inventário de uma propriedade fictícia na Amazônia. Estes dados são meramente ilustrativos e não tem valor real. O objetivo aqui é apresentar algumas particularidades da construção de gráficos de barras no R e facilitar a vida de quem quer abandonar os gráficos do Excel.</p>
<pre class="r"><code>if (!require(&quot;pacman&quot;)) install.packages(&quot;pacman&quot;)
pacman::p_load(readr, dplyr, ggplot2, ggthemes)</code></pre>
<pre class="r"><code>dados &lt;- read_csv2(
  &quot;https://raw.githubusercontent.com/italocegatta/italocegatta.github.io_source/master/content/dados/base_amazonia.csv&quot;
)

dados</code></pre>
<pre><code>## # A tibble: 276 x 7
##    Especie          Nome_cientifico     Comercial   DAP  HCom Volume    QF
##    &lt;chr&gt;            &lt;chr&gt;               &lt;chr&gt;     &lt;int&gt; &lt;int&gt;  &lt;dbl&gt; &lt;int&gt;
##  1 NAO IDENTIFICADA Nao Identificada    Nao          20    10  0.230     2
##  2 EMBIRA           Lecythidaceae       Nao          34    13  0.830     1
##  3 NAO IDENTIFICADA Nao Identificada    Nao          18     6  0.110     1
##  4 SUCUPIRA         Leguminosae-Papili~ Nao          18     7  0.130     1
##  5 CANELA           Lauraceae           Nao          24    10  0.320     1
##  6 TACHI            Lecythidaceae       Sim          21    10  0.250     1
##  7 ENVIRA CAJU      Annonaceae          Nao          20    11  0.250     2
##  8 JUTAI            Leguminosae-Caesal~ Nao          38    13  1.04      2
##  9 CATUABA          Vochysiaceae        Sim          57    13  2.32      1
## 10 NAO IDENTIFICADA Nao Identificada    Nao          22     7  0.190     2
## # ... with 266 more rows</code></pre>
<p>Primeiro vamos ver qual a distribuição dos indivíduos em classes de diâmetro. A Figura <a href="#fig:7-hist-dap">1</a> mostra a frequência de indivíduos em classes de diâmetro de 10 cm. Visivelmente, podemos ver que a faixa de diâmetro mais frequente está entre 15 e 35 cm (centro de classe 20 e 30 cm, respectivamente).</p>
<pre class="r"><code>ggplot(dados, aes(DAP)) +
  geom_histogram(binwidth = 10, color = &quot;white&quot;) +
  labs(x = &quot;Diâmetro (cm)&quot;, y = &quot;Frequência (arv/ha)&quot;) +
  scale_x_continuous(breaks = seq(0, 100,10)) +
  theme_few()</code></pre>
<div class="figure"><span id="fig:7-hist-dap"></span>
<img src="/post/2016-07-15-os-graficos-que-explicam-nossos-dados-histograma_files/figure-html/7-hist-dap-1.png" alt="Histograma com a frequência absoluta por classes de diâmetro." width="4000" />
<p class="caption">
Figura  1: Histograma com a frequência absoluta por classes de diâmetro.
</p>
</div>
<p>Mas, e quanto às espécies comerciais? Como elas estão distribuídas? A Figura <a href="#fig:7-hist-dap-comerc">2</a> faz esta diferenciação. E lembre-se, no manejo florestal da Amazônia só é permitido a exploração de árvores com diâmetro maior que 50 cm.</p>
<pre class="r"><code>ggplot(dados, aes(DAP, fill = Comercial)) +
  geom_histogram(binwidth = 10, color = &quot;white&quot;, alpha = 0.5) +
  labs(x = &quot;Diâmetro (cm)&quot;, y = &quot;Frequência (arv/ha)&quot;) +
  scale_x_continuous(breaks = seq(0, 100,10)) +
  theme_few() +
  theme(legend.position = c(.9, .9)) +
  scale_fill_hue(&quot;Comercial?&quot;, labels = c(&quot;Não&quot;, &quot;Sim&quot;))</code></pre>
<div class="figure"><span id="fig:7-hist-dap-comerc"></span>
<img src="/post/2016-07-15-os-graficos-que-explicam-nossos-dados-histograma_files/figure-html/7-hist-dap-comerc-1.png" alt="Histograma com a frequência absoluta por classes de diâmetro e separação pelo fator de árvores de interesse comercial." width="4000" />
<p class="caption">
Figura  2: Histograma com a frequência absoluta por classes de diâmetro e separação pelo fator de árvores de interesse comercial.
</p>
</div>
<p>Vamos melhorar um pouco mais a informação sob o ponto de vista da exploração: qual a frequência de indivíduos que são de interesse comercial e tem diâmetro mais que 50 cm? (Figura <a href="#fig:7-hist-vol-exp">3</a>).</p>
<pre class="r"><code>ggplot(dados, aes(Volume, fill = DAP &gt; 50 &amp; Comercial == &quot;Sim&quot;)) +
  geom_histogram(binwidth = 0.5, color = &quot;white&quot;, alpha = 0.5) +
  labs(x = Volume~individual ~ (m^3 / arv), y = &quot;Frequência (arv/ha)&quot;) +
  scale_y_continuous(breaks = seq(0, 150, 20)) +
  scale_x_continuous(breaks = seq(0, 10, 0.5)) +
  theme_few()  +
  theme(legend.position = c(.9, .9)) +
  scale_fill_hue(&quot;Pode explorar?&quot;, labels = c(&quot;Não&quot;, &quot;Sim&quot;))</code></pre>
<div class="figure"><span id="fig:7-hist-vol-exp"></span>
<img src="/post/2016-07-15-os-graficos-que-explicam-nossos-dados-histograma_files/figure-html/7-hist-vol-exp-1.png" alt="Histograma com a frequência absoluta por classes de volume individual e separação pelo fator de árvores de interesse comercial e diâmetro maior que 50 cm." width="4000" />
<p class="caption">
Figura  3: Histograma com a frequência absoluta por classes de volume individual e separação pelo fator de árvores de interesse comercial e diâmetro maior que 50 cm.
</p>
</div>
<p>Se quisermos ainda apresentar o gráfico em termos das frequências relativas, podemos fazer a seguinte modificação, conforme a Figura <a href="#fig:7-hist-vol-exp-rel">4</a>.</p>
<pre class="r"><code>ggplot(dados, aes(Volume, fill = DAP &gt; 50 &amp; Comercial == &quot;Sim&quot;)) +
  geom_histogram(
    aes(y = ..count../sum(..count..)),
    binwidth = 0.5, color = &quot;white&quot;, alpha = 0.5
  ) +
  labs(x =  Volume~individual ~ (m^3 / arv), y = &quot;Frequência (arv/ha)&quot;) +
  scale_y_continuous(breaks = seq(0, .5, 0.05), labels = scales::percent) +
  scale_x_continuous(breaks = seq(0, 10, 0.5)) +
  theme_few()  +
  theme(legend.position = c(.9, .9)) +
  scale_fill_hue(&quot;Pode explorar?&quot;, labels = c(&quot;Não&quot;, &quot;Sim&quot;))</code></pre>
<div class="figure"><span id="fig:7-hist-vol-exp-rel"></span>
<img src="/post/2016-07-15-os-graficos-que-explicam-nossos-dados-histograma_files/figure-html/7-hist-vol-exp-rel-1.png" alt="Histograma com a frequência relativa por classes de volume individual e separação pelo fator de árvores de interesse comercial e diâmetro maior que 50 cm." width="4000" />
<p class="caption">
Figura  4: Histograma com a frequência relativa por classes de volume individual e separação pelo fator de árvores de interesse comercial e diâmetro maior que 50 cm.
</p>
</div>
<p>Caso tenha alguma dúvida ou sugestão sobre o post, fique à vontade para fazer um comentário ou me contatar por E-mail.</p>
<pre class="r"><code>devtools::session_info()</code></pre>
<pre><code>##  setting  value                       
##  version  R version 3.4.3 (2017-11-30)
##  system   x86_64, mingw32             
##  ui       RTerm                       
##  language (EN)                        
##  collate  Portuguese_Brazil.1252      
##  tz       America/Sao_Paulo           
##  date     2018-03-24                  
## 
##  package    * version    date       source                            
##  assertthat   0.2.0      2017-04-11 CRAN (R 3.4.3)                    
##  backports    1.1.2      2017-12-13 CRAN (R 3.4.3)                    
##  base       * 3.4.3      2017-12-06 local                             
##  bindr        0.1.1      2018-03-13 CRAN (R 3.4.4)                    
##  bindrcpp     0.2        2017-06-17 CRAN (R 3.4.3)                    
##  blogdown     0.5        2018-01-24 CRAN (R 3.4.4)                    
##  bookdown     0.7        2018-02-18 CRAN (R 3.4.4)                    
##  cli          1.0.0      2017-11-05 CRAN (R 3.4.3)                    
##  colorspace   1.3-2      2016-12-14 CRAN (R 3.4.3)                    
##  compiler     3.4.3      2017-12-06 local                             
##  crayon       1.3.4      2017-09-16 CRAN (R 3.4.3)                    
##  curl         3.1        2017-12-12 CRAN (R 3.4.3)                    
##  datasets   * 3.4.3      2017-12-06 local                             
##  devtools     1.13.5     2018-02-18 CRAN (R 3.4.3)                    
##  digest       0.6.15     2018-01-28 CRAN (R 3.4.3)                    
##  dplyr      * 0.7.4      2017-09-28 CRAN (R 3.4.3)                    
##  evaluate     0.10.1     2017-06-24 CRAN (R 3.4.3)                    
##  ggplot2    * 2.2.1.9000 2018-03-25 Github (tidyverse/ggplot2@3c9c504)
##  ggthemes   * 3.4.0      2017-02-19 CRAN (R 3.4.3)                    
##  glue         1.2.0      2017-10-29 CRAN (R 3.4.3)                    
##  graphics   * 3.4.3      2017-12-06 local                             
##  grDevices  * 3.4.3      2017-12-06 local                             
##  grid         3.4.3      2017-12-06 local                             
##  gtable       0.2.0      2016-02-26 CRAN (R 3.4.3)                    
##  highr        0.6        2016-05-09 CRAN (R 3.4.3)                    
##  hms          0.4.2      2018-03-10 CRAN (R 3.4.4)                    
##  htmltools    0.3.6      2017-04-28 CRAN (R 3.4.3)                    
##  knitr        1.20       2018-02-20 CRAN (R 3.4.4)                    
##  labeling     0.3        2014-08-23 CRAN (R 3.4.1)                    
##  lazyeval     0.2.1      2017-10-29 CRAN (R 3.4.3)                    
##  magrittr     1.5        2014-11-22 CRAN (R 3.4.3)                    
##  memoise      1.1.0      2017-04-21 CRAN (R 3.4.3)                    
##  methods    * 3.4.3      2017-12-06 local                             
##  munsell      0.4.3      2016-02-13 CRAN (R 3.4.3)                    
##  pacman     * 0.4.6      2017-05-14 CRAN (R 3.4.3)                    
##  pillar       1.2.1      2018-02-27 CRAN (R 3.4.4)                    
##  pkgconfig    2.0.1      2017-03-21 CRAN (R 3.4.3)                    
##  plyr         1.8.4      2016-06-08 CRAN (R 3.4.3)                    
##  R6           2.2.2      2017-06-17 CRAN (R 3.4.3)                    
##  Rcpp         0.12.16    2018-03-13 CRAN (R 3.4.4)                    
##  readr      * 1.1.1      2017-05-16 CRAN (R 3.4.3)                    
##  rlang        0.2.0.9001 2018-03-25 Github (r-lib/rlang@870a6bf)      
##  rmarkdown    1.9        2018-03-01 CRAN (R 3.4.4)                    
##  rprojroot    1.3-2      2018-01-03 CRAN (R 3.4.3)                    
##  scales       0.5.0.9000 2018-02-11 Github (hadley/scales@d767915)    
##  stats      * 3.4.3      2017-12-06 local                             
##  stringi      1.1.7      2018-03-12 CRAN (R 3.4.4)                    
##  stringr      1.3.0      2018-02-19 CRAN (R 3.4.4)                    
##  tibble       1.4.2      2018-01-22 CRAN (R 3.4.3)                    
##  tools        3.4.3      2017-12-06 local                             
##  utf8         1.1.3      2018-01-03 CRAN (R 3.4.3)                    
##  utils      * 3.4.3      2017-12-06 local                             
##  withr        2.1.2      2018-03-25 Github (jimhester/withr@79d7b0d)  
##  xfun         0.1        2018-01-22 CRAN (R 3.4.4)                    
##  yaml         2.1.18     2018-03-08 CRAN (R 3.4.4)</code></pre>
